/*
 * This file was generated by the Gradle 'init' task.
 */

buildscript {
    ext.kotlin_version = '1.4.21'
    repositories {
        mavenCentral()
    }
    dependencies {
        classpath "org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version"
    }
//    ext {
//        springBootVersion = '1.5.3.RELEASE'
//    }
//    repositories {
//        mavenCentral()
//    }
//    dependencies {
//        classpath("org.springframework.boot:spring-boot-gradle-plugin:${springBootVersion}")
//    }
}

plugins {
    id 'java'
    id 'maven-publish'

    id "org.springframework.boot" version "2.0.0.RELEASE"

//    id 'org.springframework.boot' version '1.5.3.RELEASE'

    // Create start scripts
    // Is executed on "build" task but not on e.g. "jar" task
    //id 'application'

    // Bundle all dependencies into one fat shadowed jar
    // (Gets automatically triggered when application plugin is present)
    //id 'com.github.johnrengelman.shadow'
}
apply plugin: 'kotlin'
//apply plugin: 'org.springframework.boot'

ext {
    _group = applicationGroup
    _module = applicationModule
    _mainClass = _group + "." + _module + ".Application"
    _title = applicationTitle
}

// application plugin configuration
//applicationName = _title
//mainClassName = _mainClass

repositories {
    jcenter()
    mavenLocal()
    maven {
        url = uri('https://repo.maven.apache.org/maven2')
    }
}

dependencies {
    implementation 'commons-io:commons-io:2.5'
    implementation 'commons-fileupload:commons-fileupload:1.3.2'
    implementation 'io.springfox:springfox-swagger2:2.6.1'
    implementation 'io.springfox:springfox-swagger-ui:2.6.1'
    implementation 'com.fasterxml.jackson.core:jackson-databind:2.8.8'
    implementation 'org.springframework.boot:spring-boot-starter-jersey:1.5.3.RELEASE'
    implementation 'org.springframework.boot:spring-boot-starter-web:1.5.3.RELEASE'
    implementation 'org.projectlombok:lombok:1.16.16'
    implementation 'org.springframework.boot:spring-boot-configuration-processor:1.5.3.RELEASE'
    runtimeOnly 'org.springframework.boot:spring-boot-devtools:1.5.3.RELEASE'
    testImplementation 'org.springframework.boot:spring-boot-starter-test:1.5.3.RELEASE'
    implementation "org.jetbrains.kotlin:kotlin-stdlib-jdk8:$kotlin_version"
}

// jar configuration
jar {
    // add Manifest to jar
    manifest {
        attributes 'Implementation-Title': applicationTitle,
                'Implementation-Version': version,
                'Main-Class': _mainClass
    }
    from { configurations.compile.collect { it.isDirectory() ? it : zipTree(it) } }
}

// Appends entries in META-INF/services resources into a single resource. Not sure, if needed.
// see: https://github.com/johnrengelman/shadow/blob/master/src/main/groovy/com/github/jengelman/gradle/plugins/shadow/transformers/ServiceFileTransformer.groovy
//shadowJar {
//    mergeServiceFiles()
//}

// deactivate zip generations in distributions folder as they are not very useful and take relatively much build time
//tasks.distZip.enabled = false
//tasks.shadowDistZip.enabled = false

sourceCompatibility = '1.8'
compileKotlin {
    kotlinOptions {
        jvmTarget = "1.8"
    }
}
compileTestKotlin {
    kotlinOptions {
        jvmTarget = "1.8"
    }
}

//publishing {
//    publications {
//        maven(MavenPublication) {
//            from(components.java)
//        }
//    }
//}

//tasks.withType(JavaCompile) {
//    options.encoding = 'UTF-8'
//}
